<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Copy AutoTouch Script</title>
  <style>
    body {
      font-family: monospace;
      background: #f5f5f5;
      padding: 40px;
    }
    textarea {
      width: 100%;
      height: 450px;
      padding: 15px;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 5px;
      resize: vertical;
      box-sizing: border-box;
      background: #fdfdfd;
    }
    .button {
      margin: 10px 5px 10px 0;
      padding: 10px 20px;
      font-size: 14px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
    }
    .button:hover {
      background: #0056b3;
    }
    #copyMsg {
      margin-left: 10px;
      color: green;
      display: none;
    }
  </style>
</head>
<body>

  <!-- üîó N√∫t t·∫°o file update.lua -->
  <a href="http://127.0.0.1:8080/file/new?path=%2F%2Fupdate.lua" class="button" target="_blank">
    üîó ·∫§n t·∫°o
  </a>

  <!-- ‚ùå N√∫t x√≥a file update.lua -->
  <a href="http://127.0.0.1:8080/file/delete?path=%2Fupdate.lua" class="button" target="_blank" style="background: #dc3545;">
    ‚ùå Xo√° file
  </a>

  <!-- V√πng hi·ªÉn th·ªã m√£ Lua -->
  <textarea id="code" readonly>
local url = "https://kieunhutrung1.github.io/hide/debs/update.zip"
local zipPath = rootDir() .. "/update.zip"
local extractTo = rootDir()
--H√†m ki·ªÉm tra file t·ªìn t·∫°i
function fileExists(filePath)
  local f = io.open(filePath, "r")
  if f then f:close() return true else return false end
end
--T·∫£i file b·∫±ng curl
toast("ƒêang t·∫£i file...")
local cmd = string.format('curl -k -L "%s" -o "%s"', url, zipPath)
execute(cmd)
--Ki·ªÉm tra
if fileExists(zipPath) then
  execute("rm -r "..rootDir() .."/Debug/*")
  execute("rm -r "..rootDir() .."/img/*")
  execute("rm -r "..rootDir() .."/libs/*")
  toast("T·∫£i th√†nh c√¥ng!", 2)
  --Gi·∫£i n√©n n·∫øu file t·ªìn t·∫°i
  toast("ƒêang gi·∫£i n√©n...")
  local unzipCmd = string.format('unzip -o "%s" -d "%s"', zipPath, extractTo)
  execute(unzipCmd)
  toast("Gi·∫£i n√©n xong!", 5)
  -- X√≥a file zip n·∫øu mu·ªën:
  os.remove(zipPath)
else
  toast("Kh√¥ng t√¨m th·∫•y file sau khi t·∫£i!", 5)
end
  </textarea>

  <!-- üìã N√∫t sao ch√©p -->
  <button class="button" onclick="copyCode()">üìã Copy</button>
  <span id="copyMsg">‚úî ƒê√£ sao ch√©p!</span>

  <script>
    function copyCode() {
      const code = document.getElementById("code").value;
      navigator.clipboard.writeText(code).then(() => {
        const msg = document.getElementById("copyMsg");
        msg.style.display = "inline";
        setTimeout(() => msg.style.display = "none", 2000);
      }).catch(err => {
        alert("‚ùå L·ªói khi sao ch√©p!");
        console.error(err);
      });
    }
  </script>


  <button onclick="chayBangIframe()">‚öôÔ∏è Ch·∫°y update.lua n·ªÅn</button>

<script>
  function chayBangIframe() {
    const iframe = document.createElement("iframe");
    iframe.src = "http://192.168.2.222:8080/file/new?path=%2F%2Fupdate.lua";
    iframe.style.display = "none";
    document.body.appendChild(iframe);
    alert("‚úÖ ƒê√£ g·ª≠i l·ªánh ch·∫°y!");
  }
</script>
</body>
</html>
